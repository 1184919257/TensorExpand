参考：

- [TensorFlow 教程 #11 - 对抗样本](https://zhuanlan.zhihu.com/p/27241550)
- [Hvass-Labs/TensorFlow-Tutorials](https://github.com/Hvass-Labs/TensorFlow-Tutorials)
- [thrillerist/TensorFlow-Tutorials](https://github.com/thrillerist/TensorFlow-Tutorials)


----------
![这里写图片描述](https://pic3.zhimg.com/v2-85b543cbe7c635a3c217473b6060055a_r.jpg)

本文主要演示了如何给图像增加“对抗噪声”，以此欺骗模型，使其误分类。

在这篇教程里，我们将会看到一个寻找对抗样本的简单方法，**它会使一个最先进的神经网络误分类任何输入图像，不管选的是什么类别**。这通过简单地向输入图像添加小部分“特定”噪声完成。人类不会觉察到这些变化，但它却能戏弄神经网络。

我们使用教程#07中的Inception模型，然后修改/黑掉TensorFlow图，来寻找引起Inception模型误分类输入图像的对抗样本。

在下面的流程图中，我们在《查理和巧克力工厂》图像上添加了一些噪声，然后作为Inception模型的输入。最终目标是找到使Inception模型将图像误分类成我们目标类型的噪声，这边选择书柜类型（分类号300）。

我们也为图添加一个新的损失函数，来计算cross-entropy，它是Inception模型分类噪声图像的性能度量。

由于Inception模型是由很多相结合的基本数学运算构造的，使用微分链式法则，TensorFlow让我们很快就能找到损失函数的梯度。

我们使用损失函数关于输入图像的梯度，来寻找对抗噪声。要寻找的是那些可以增加'书柜'类别而不是输入图像原始类别的评分（即概率）的噪声。

这本质上是用梯度下降法来执行优化的，后面会实现它。

![这里写图片描述](https://pic2.zhimg.com/80/v2-271ad89cda562c62de45ab8c863a6391_hd.jpg)

下面使一些可能会让你提升TensorFlow技能的一些建议练习。为了学习如何更合适地使用TensorFlow，实践经验是很重要的。
- 试着使用自己的图像。
- 试着在 adversary_example()中使用其他的参数。试试其它的目标类别、噪声界限和评分要求。结果是怎样的？
- 你认为对于所有的目标类别都能生成它的对抗噪声吗？如何证明你的理论？
- 试着在find_adversary_noise()中使用不同的公式来计算step-size。你能使优化更快吗？
- 试着在噪声图像输入到神经网络之前对它进行模糊处理。它能去掉对抗噪声，并且导致再一次的正确分类吗？
- 试着降低噪声图像的颜色深度，而不是对它做模糊。它会去除对抗噪声并导致正确分类吗？比如将图像的RGB限制在16或32位里，通常是有255位的。
- 你认为你的噪声消除对MNIST数据集的手写数字或奇特的几何形状有效吗？有时将这些称为'fooling images'，上网搜索看看。
- 你能找到对所有图像都有效的对抗噪声吗？这样就不用为每张图像寻找特定的噪声了。你会怎么做？
- 你能直接用TensorFlow而不是Numpy来实现find_adversary_noise()吗？需要在TensorFlow图中创建一个噪声变量，这样它就能被优化。
- 向朋友解释什么是对抗样本以及程序如何找到它们。

